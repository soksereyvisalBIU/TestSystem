import{c as J,a as B,j as t}from"./app-qZM_P6kk.js";import{B as K}from"./button-Cu49OhpK.js";import{u as U,d as W,a as M,S as A,D as P,c as R,b as H,v as V,P as X}from"./SortableItem-fE5CIPcU.js";import{L as Y}from"./layout-list-kNGyUi5l.js";import{S as Z}from"./save-T9n9ZH9n.js";import{G as ee}from"./grip-horizontal-DUQkg73B.js";import{G as te}from"./grip-vertical-DtmND-Rm.js";/* empty css            */import"./index-FDL-Y6Vk.js";import"./index-B5hr3jbO.js";import"./index-CHXMgrNC.js";import"./utils-CFcDjcb_.js";import"./createLucideIcon-B5oQhXDR.js";function ge(a){const e=J.c(36),{questions:b,onSave:G}=a;let y;if(e[0]!==b){const i=new Map;b.forEach(r=>{i.has(r.type)||i.set(r.type,[]),i.get(r.type).push(r)}),y=Array.from(i.entries()).map(oe),e[0]=b,e[1]=y}else y=e[1];const h=y,[o,q]=B.useState(h);let v,g;e[2]!==h?(v=()=>{q(h)},g=[h],e[2]=h,e[3]=v,e[4]=g):(v=e[3],g=e[4]),B.useEffect(v,g);let j;e[5]===Symbol.for("react.memo_cache_sentinel")?(j={activationConstraint:{distance:5}},e[5]=j):j=e[5];const d=U(W(X,j));let S;e[6]!==o?(S=i=>{const{active:r,over:s}=i;if(!s||r.id===s.id)return;const l=r.id.toString().split(":")[1],L=s.id.toString().split(":")[1],_=o.findIndex(n=>n.type===l),k=o.findIndex(n=>n.type===L);_===-1||k===-1||q(n=>M(n,_,k))},e[6]=o,e[7]=S):S=e[7];const C=S;let N;e[8]===Symbol.for("react.memo_cache_sentinel")?(N=(i,r)=>{const{active:s,over:l}=r;if(!l||s.id===l.id)return;const L=s.id.toString().split(":")[1],_=l.id.toString().split(":")[1];q(k=>k.map(n=>{if(n.type!==i)return n;const Q=n.questions.findIndex(O=>O.id.toString()===L),T=n.questions.findIndex(O=>O.id.toString()===_);return Q===-1||T===-1?n:{...n,questions:M(n.questions,Q,T)}}))},e[8]=N):N=e[8];const F=N;let w;e[9]!==G||e[10]!==o?(w=()=>{const r=o.flatMap(ie).map(se);G(r)},e[9]=G,e[10]=o,e[11]=w):w=e[11];const z=w;let I;e[12]===Symbol.for("react.memo_cache_sentinel")?(I=t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"p-1.5 bg-primary/10 rounded-lg",children:t.jsx(Y,{className:"w-4 h-4 text-primary"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-bold text-title",children:"Quiz Structure"}),t.jsx("p",{className:"text-[10px] text-description font-medium uppercase tracking-wider",children:"Grouped by Type"})]})]}),e[12]=I):I=e[12];let $;e[13]===Symbol.for("react.memo_cache_sentinel")?($=t.jsx(Z,{className:"w-3.5 h-3.5"}),e[13]=$):$=e[13];let c;e[14]!==z?(c=t.jsxs("div",{className:"bg-muted/50 px-5 py-4 flex items-center justify-between border-b border-border",children:[I,t.jsxs(K,{variant:"default",size:"sm",onClick:z,className:"h-8 gap-2 bg-primary text-primary-foreground hover:bg-primary/90 shadow-sm transition-all active:scale-95",children:[$,"Save Order"]})]}),e[14]=z,e[15]=c):c=e[15];let m;e[16]!==o?(m=o.map(re),e[16]=o,e[17]=m):m=e[17];let p;if(e[18]!==o||e[19]!==d){let i;e[21]!==d?(i=r=>t.jsx(A,{id:`group:${r.type}`,children:t.jsxs("div",{className:"group/parent relative rounded-xl border border-border bg-background p-1 transition-all hover:border-primary/30 hover:shadow-md",children:[t.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-muted/30 rounded-t-lg border-b border-border cursor-grab active:cursor-grabbing",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ee,{className:"w-4 h-4 text-muted-foreground group-hover/parent:text-primary transition-colors"}),t.jsx("span",{className:"text-[11px] font-black text-subtitle uppercase tracking-widest",children:r.type.replaceAll("_"," ")})]}),t.jsxs("span",{className:"text-[10px] bg-card border border-border px-2 py-0.5 rounded-full font-bold text-description",children:[r.questions.length," Items"]})]}),t.jsx("div",{className:"p-2",children:t.jsx(P,{sensors:d,collisionDetection:R,onDragEnd:s=>F(r.type,s),children:t.jsx(H,{items:r.questions.map(s=>`${r.type}:${s.id}`),strategy:V,children:t.jsx("div",{className:"space-y-1",children:r.questions.map((s,l)=>t.jsx(A,{id:`${r.type}:${s.id}`,children:t.jsxs("div",{className:"group/item flex items-center gap-3 rounded-lg border border-transparent hover:border-border hover:bg-muted/50 px-3 py-2 cursor-grab active:cursor-grabbing transition-all",children:[t.jsx(te,{className:"w-3.5 h-3.5 text-muted-foreground/40 group-hover/item:text-muted-foreground"}),t.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[t.jsx("span",{className:"flex-shrink-0 w-5 h-5 flex items-center justify-center rounded-md bg-card border border-border text-[10px] font-black text-description",children:l+1}),t.jsx("span",{className:"text-xs text-body font-medium truncate",children:s.question_text||s.question})]})]})},`${r.type}:${s.id}`))})})})})]})},`group:${r.type}`),e[21]=d,e[22]=i):i=e[22],p=o.map(i),e[18]=o,e[19]=d,e[20]=p}else p=e[20];let x;e[23]!==p?(x=t.jsx("div",{className:"space-y-4",children:p}),e[23]=p,e[24]=x):x=e[24];let u;e[25]!==m||e[26]!==x?(u=t.jsx(H,{items:m,strategy:V,children:x}),e[25]=m,e[26]=x,e[27]=u):u=e[27];let f;e[28]!==C||e[29]!==d||e[30]!==u?(f=t.jsx("div",{className:"p-4 overflow-y-auto max-h-[60vh] custom-scrollbar bg-card",children:t.jsx(P,{sensors:d,collisionDetection:R,onDragEnd:C,children:u})}),e[28]=C,e[29]=d,e[30]=u,e[31]=f):f=e[31];let D;e[32]===Symbol.for("react.memo_cache_sentinel")?(D=t.jsx("div",{className:"p-3 bg-muted/50 border-t border-border",children:t.jsx("p",{className:"text-[10px] text-center text-description font-medium",children:"Drag blocks to reorder types, or items to reorder questions."})}),e[32]=D):D=e[32];let E;return e[33]!==c||e[34]!==f?(E=t.jsxs("div",{className:"w-full max-w-md rounded-2xl border border-border bg-card shadow-xl overflow-hidden animate-in fade-in zoom-in-95 duration-300",children:[c,f,D]}),e[33]=c,e[34]=f,e[35]=E):E=e[35],E}function re(a){return`group:${a.type}`}function se(a,e){return{...a,order:e+1,updated:!0}}function ie(a){return a.questions}function oe(a){const[e,b]=a;return{type:e,questions:[...b].sort(ne)}}function ne(a,e){return a.order-e.order}export{ge as default};
