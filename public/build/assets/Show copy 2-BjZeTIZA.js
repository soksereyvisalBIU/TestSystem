import{c as le,u as fe,j as t,H as be,a as he}from"./app-DbC9swOp.js";import{s as ge}from"./index-ikzcNs2d.js";import{d as je}from"./dayjs.min-B7ZjrZ6U.js";import{A as ye}from"./app-layout-DB38e1tJ.js";import{Card as we,CardHeader as _e,CardContent as Ne,Badge as re}from"./Card-CCSqcF8E.js";import"./app-B-j88FTB.js";import"./index-BLROG9a-.js";import"./index-OyaHfcK1.js";import"./index-DrZ1WBgl.js";import"./index-CHXMgrNC.js";import"./utils-CFcDjcb_.js";import"./button-B0cnHsLL.js";import"./dialog-XIh-d8In.js";import"./index-GNnbXVu0.js";import"./index-DfdQaTH4.js";import"./index-DUVlDvZK.js";import"./index-DpP96dE-.js";import"./index-CGmkGWeF.js";import"./index-C5noA0MZ.js";import"./index-CFZJ_iCf.js";import"./x-BcxDNo4d.js";import"./createLucideIcon-CwNQQ2Lr.js";import"./tooltip-BjGVwsVz.js";import"./index-DKfa_JjE.js";import"./index-BI2ZCWKw.js";import"./index-BSo9miKG.js";import"./index-vo4ULvVg.js";import"./index-BF2HzXLa.js";import"./avatar-BQA4Z3p_.js";import"./index-CoyZhxZx.js";import"./index-BZB35nAZ.js";import"./index-CMWG4mbA.js";import"./command-RsIjOFqg.js";import"./search-i8E80oUt.js";import"./app-logo-icon-CI-oZLFk.js";import"./layout-grid-DjmK7l_J.js";import"./users-Ba4Nng5e.js";import"./settings-2-DvxrLHlG.js";import"./cpu-H_bfj-VP.js";import"./book-open-DpTjyKmw.js";import"./chevron-right-BLPhb5io.js";import"./appearance-tabs-header-B5XtEuQ0.js";import"./sun-D2aYdR0-.js";const ve=(a,e)=>{const s=parseFloat(a.point||0);let r=0,i="unanswered";if(!e||e.length===0)return{earnedPoints:r,maxPoints:s,status:i};switch(a.type){case"true_false":case"multiple_choice":{const n=e[0],c=a.options.find(l=>l.is_correct===1);c&&n.answer_text===c.option_text?(r=s,i="correct"):i="incorrect";break}case"fill_blank":case"short_answer":{const n=e[0];a.options.find(l=>l.option_text.trim().toLowerCase()===(n.answer_text||"").trim().toLowerCase())?(r=s,i="correct"):i="review";break}case"matching":{const n=a.options.length,c=n>0?s/n:0;let l=0;a.options.forEach(u=>{const m=e.find(x=>x.option_id===u.id);m&&m.answer_text===u.match_key&&l++}),r=l*c,i=l===n?"correct":l===0?"incorrect":"partial";break}}return{earnedPoints:parseFloat(r.toFixed(2)),maxPoints:parseFloat(s.toFixed(2)),status:i}},Se=a=>{switch(a){case"correct":return t.jsx(re,{className:"border border-green-200 bg-green-100 text-green-700",children:"Correct"});case"incorrect":return t.jsx(re,{className:"border border-red-200 bg-red-100 text-red-700",children:"Incorrect"});case"partial":return t.jsx(re,{className:"border border-yellow-200 bg-yellow-100 text-yellow-800",children:"Partially Correct"});case"review":return t.jsx(re,{className:"border border-orange-200 bg-orange-100 text-orange-800",children:"Needs Review"});default:return t.jsx(re,{className:"border border-gray-200 bg-gray-100 text-gray-600",children:"No Answer"})}},ke=a=>{const e=le.c(7),{question:s,answers:r}=a;let i;if(e[0]!==r||e[1]!==s.options){let c;e[3]!==r?(c=l=>{const m=r.find(o=>o.option_id===l.id)?.answer_text||"—",x=m===l.match_key;return t.jsxs("div",{className:`flex flex-col items-start justify-between rounded-lg border p-3 sm:flex-row sm:items-center ${x?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:[t.jsx("div",{className:"mb-2 w-full font-medium text-gray-700 sm:mb-0 sm:w-1/2",children:l.option_text}),t.jsx("div",{className:"mx-4 hidden text-gray-400 sm:block",children:"→"}),t.jsxs("div",{className:"flex w-full flex-col items-end gap-1 sm:w-1/2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-xs font-semibold tracking-wider text-gray-500 uppercase",children:"Student:"}),t.jsx("span",{className:`font-medium ${x?"text-green-700":"text-red-700"}`,children:m})]}),!x&&t.jsxs("div",{className:"rounded bg-green-100 px-2 py-1 text-xs text-green-700",children:["Correct: ",l.match_key]})]})]},l.id)},e[3]=r,e[4]=c):c=e[4],i=s.options.map(c),e[0]=r,e[1]=s.options,e[2]=i}else i=e[2];let n;return e[5]!==i?(n=t.jsx("div",{className:"mt-4 grid gap-3",children:i}),e[5]=i,e[6]=n):n=e[6],n},Ce=a=>{const e=le.c(9),{question:s,answers:r}=a;let i;e[0]!==r[0]?(i=r[0]||{},e[0]=r[0],e[1]=i):i=e[1];const c=i.answer_text;let l;if(e[2]!==s.options||e[3]!==c){let m;e[5]!==c?(m=x=>{const o=c===x.option_text,p=x.is_correct===1;let d="border-gray-200 bg-white hover:bg-gray-50";return o&&p?d="border-green-300 bg-green-50 ring-1 ring-green-300":o&&!p?d="border-red-300 bg-red-50 ring-1 ring-red-300":!o&&p&&(d="border-green-300 bg-white ring-1 ring-green-300 border-dashed"),t.jsxs("div",{className:`flex items-center rounded-lg border p-3 transition-all ${d}`,children:[t.jsx("div",{className:`mr-3 flex h-5 w-5 items-center justify-center rounded-full border ${o?p?"border-green-500 bg-green-500 text-white":"border-red-500 bg-red-500 text-white":"border-gray-300"}`,children:o&&t.jsx("svg",{className:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"3",d:"M5 13l4 4L19 7"})})}),t.jsx("span",{className:`flex-1 ${p?"font-semibold text-gray-900":"text-gray-700"}`,children:x.option_text}),p&&!o&&t.jsx("span",{className:"px-2 text-xs font-medium text-green-600",children:"Correct Answer"})]},x.id)},e[5]=c,e[6]=m):m=e[6],l=s.options.map(m),e[2]=s.options,e[3]=c,e[4]=l}else l=e[4];let u;return e[7]!==l?(u=t.jsx("div",{className:"mt-4 space-y-2",children:l}),e[7]=l,e[8]=u):u=e[8],u},Pe=a=>{const e=le.c(33),{question:s,answers:r,onTeacherScore:i}=a;let n;e[0]!==r[0]?(n=r[0]||{},e[0]=r[0],e[1]=n):n=e[1];const c=n,l=c.answer_text||"",u=s.options.map(Ee);let m;e[2]!==l?(m=A=>A.trim().toLowerCase()===l.trim().toLowerCase(),e[2]=l,e[3]=m):m=e[3];const x=u.some(m),[o,p]=he.useState(c.manual_score??""),d=parseFloat(s.point||0);let y;e[4]!==d||e[5]!==i||e[6]!==s.id?(y=A=>{let N=parseFloat(A);isNaN(N)&&(N=""),N>d&&(N=d),N<0&&(N=0),p(N),i?.(s.id,N)},e[4]=d,e[5]=i,e[6]=s.id,e[7]=y):y=e[7];const f=y,_="mt-4 space-y-4";let w;e[8]===Symbol.for("react.memo_cache_sentinel")?(w=t.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-500",children:"Your Answer"}),e[8]=w):w=e[8];const v=`rounded-md border p-3 ${x?"border-green-200 bg-green-50 text-green-800":"border-red-200 bg-red-50 text-red-800"}`;let g;e[9]!==l?(g=l||t.jsx("span",{className:"text-gray-400 italic",children:"No answer submitted"}),e[9]=l,e[10]=g):g=e[10];let b;e[11]!==v||e[12]!==g?(b=t.jsxs("div",{children:[w,t.jsx("div",{className:v,children:g})]}),e[11]=v,e[12]=g,e[13]=b):b=e[13];const j=!x&&u.length>0&&t.jsxs("div",{children:[t.jsx("label",{className:"mb-1 block text-sm font-medium text-green-700",children:"Expected Answer(s)"}),t.jsx("div",{className:"rounded-md border border-green-200 bg-white p-3 text-gray-700",children:t.jsx("ul",{className:"list-inside list-disc",children:u.map(Me)})})]});let h;e[14]!==d?(h=t.jsxs("label",{className:"mb-2 block text-sm font-semibold text-gray-800",children:["Teacher Score (0 - ",d,")"]}),e[14]=d,e[15]=h):h=e[15];let S;e[16]!==f?(S=A=>f(A.target.value),e[16]=f,e[17]=S):S=e[17];let k;e[18]!==o||e[19]!==d||e[20]!==S?(k=t.jsx("input",{type:"number",min:"0",max:d,step:"0.25",value:o,onChange:S,className:"w-32 rounded-md border bg-white p-2 text-gray-800 focus:border-blue-500 focus:ring-2 focus:ring-blue-500",placeholder:"Enter score"}),e[18]=o,e[19]=d,e[20]=S,e[21]=k):k=e[21];let C;e[22]!==o||e[23]!==d?(C=o!==""&&t.jsxs("p",{className:"mt-1 text-xs text-green-600",children:["Score saved: ",o," / ",d]}),e[22]=o,e[23]=d,e[24]=C):C=e[24];let P;e[25]!==h||e[26]!==k||e[27]!==C?(P=t.jsxs("div",{className:"border-t border-gray-100 pt-4",children:[h,k,C]}),e[25]=h,e[26]=k,e[27]=C,e[28]=P):P=e[28];let q;return e[29]!==P||e[30]!==b||e[31]!==j?(q=t.jsxs("div",{className:_,children:[b,j,P]}),e[29]=P,e[30]=b,e[31]=j,e[32]=q):q=e[32],q},qe=a=>{const e=le.c(40),{question:s,answers:r,onTeacherScore:i}=a;let n,c,l,u,m,x,o,p;if(e[0]!==r||e[1]!==i||e[2]!==s){n=ve(s,r);const v=r[0]?.manual_score;c=v??n.earnedPoints;const g=v!=null?"review":n.status;x="h-full flex flex-col",e[11]!==s.question_text?(o=t.jsx("div",{className:"mb-4 text-lg leading-relaxed font-medium text-gray-900",dangerouslySetInnerHTML:{__html:s.question_text}}),e[11]=s.question_text,e[12]=o):o=e[12];let b;e[13]!==r||e[14]!==s?(b=s.type==="matching"&&t.jsx(ke,{question:s,answers:r}),e[13]=r,e[14]=s,e[15]=b):b=e[15];let j;e[16]!==r||e[17]!==s?(j=(s.type==="multiple_choice"||s.type==="true_false")&&t.jsx(Ce,{question:s,answers:r}),e[16]=r,e[17]=s,e[18]=j):j=e[18];const h=(s.type==="short_answer"||s.type==="fill_blank")&&t.jsx(Pe,{question:s,answers:r,onTeacherScore:i});e[19]!==b||e[20]!==j||e[21]!==h?(p=t.jsxs("div",{className:"flex-grow",children:[b,j,h]}),e[19]=b,e[20]=j,e[21]=h,e[22]=p):p=e[22],m="mt-6 flex items-center justify-between border-t border-gray-100 pt-4",l="flex items-center gap-3",u=Se(g),e[0]=r,e[1]=i,e[2]=s,e[3]=n,e[4]=c,e[5]=l,e[6]=u,e[7]=m,e[8]=x,e[9]=o,e[10]=p}else n=e[3],c=e[4],l=e[5],u=e[6],m=e[7],x=e[8],o=e[9],p=e[10];let d;e[23]!==c?(d=t.jsx("span",{className:"font-bold text-gray-900",children:c}),e[23]=c,e[24]=d):d=e[24];let y;e[25]!==n.maxPoints||e[26]!==d?(y=t.jsxs("span",{className:"text-sm text-gray-500",children:["Score: ",d," / ",n.maxPoints]}),e[25]=n.maxPoints,e[26]=d,e[27]=y):y=e[27];let f;e[28]!==l||e[29]!==u||e[30]!==y?(f=t.jsxs("div",{className:l,children:[u,y]}),e[28]=l,e[29]=u,e[30]=y,e[31]=f):f=e[31];let _;e[32]!==m||e[33]!==f?(_=t.jsx("div",{className:m,children:f}),e[32]=m,e[33]=f,e[34]=_):_=e[34];let w;return e[35]!==_||e[36]!==x||e[37]!==o||e[38]!==p?(w=t.jsxs("div",{className:x,children:[o,p,_]}),e[35]=_,e[36]=x,e[37]=o,e[38]=p,e[39]=w):w=e[39],w};function kt(a){const e=le.c(115),{assessment:s,attempt:r}=a;let i;e[0]!==r.answers?(i=r.answers.map(Le),e[0]=r.answers,e[1]=i):i=e[1];let n;e[2]!==i?(n={scores:i},e[2]=i,e[3]=n):n=e[3];const{data:c,setData:l,post:u,processing:m}=fe(n);let x;e[4]!==l?(x=(F,$)=>{l("scores",T=>T.map(L=>L.question_id===F?{...L,manual_score:$}:L))},e[4]=l,e[5]=x):x=e[5];const o=x;let p;e[6]!==s.id||e[7]!==r.student_id||e[8]!==u?(p=F=>{F.preventDefault(),u(ge("instructor.classes.subjects.assessments.students.store",{class:1,subject:1,assessment:s.id,student:r.student_id}),{onSuccess:Te,onError:$e})},e[6]=s.id,e[7]=r.student_id,e[8]=u,e[9]=p):p=e[9];const d=p;let y;e[10]!==c.scores?(y=c.scores.reduce(Ae,{}),e[10]=c.scores,e[11]=y):y=e[11];const f=y;let _,w,v,g,b,j,h,S,k,C,P,q,A,N,E,M,te,se;if(e[12]!==f||e[13]!==s.description||e[14]!==s.questions||e[15]!==s.title||e[16]!==r.status||e[17]!==r.updated_at||e[18]!==d){se=s.questions.reduce(Fe,0);let F;e[37]!==f?(F=(xe,ue)=>{const pe=f[ue.id]||[];return xe+(pe[0]?.manual_score??0)},e[37]=f,e[38]=F):F=e[38],te=s.questions.reduce(F,0);let $,T;e[39]===Symbol.for("react.memo_cache_sentinel")?($={title:"Dashboard",href:"/dashboard"},T={title:"Assessments",href:"/assessments"},e[39]=$,e[40]=T):($=e[39],T=e[40]);let L;e[41]!==s.title?(L=[$,T,{title:s.title,href:"#"}],e[41]=s.title,e[42]=L):L=e[42];const me=L;_=ye,P=me;const de=`Results: ${s.title}`;e[43]!==de?(q=t.jsx(be,{title:de}),e[43]=de,e[44]=q):q=e[44],k=d,C="mx-auto max-w-5xl space-y-8 pb-12 mt-6",S="rounded-2xl border border-gray-200 bg-white p-6 shadow-sm sm:p-8",j="flex flex-col justify-between gap-6 md:flex-row md:items-start";let J;e[45]!==s.title?(J=t.jsx("h1",{className:"text-3xl font-extrabold text-gray-900",children:s.title}),e[45]=s.title,e[46]=J):J=e[46];let K;e[47]!==s.description?(K=t.jsx("p",{className:"mt-2 max-w-2xl text-gray-500",children:s.description}),e[47]=s.description,e[48]=K):K=e[48];let oe;e[49]===Symbol.for("react.memo_cache_sentinel")?(oe=t.jsx("span",{className:"mr-2 font-medium",children:"Status:"}),e[49]=oe):oe=e[49];let V;e[50]!==r.status?(V=t.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[oe,t.jsx("span",{className:"rounded-md bg-blue-100 px-2 py-0.5 text-xs font-bold tracking-wide text-blue-700 uppercase",children:r.status})]}),e[50]=r.status,e[51]=V):V=e[51];let ae;e[52]===Symbol.for("react.memo_cache_sentinel")?(ae=t.jsx("span",{className:"mr-2 font-medium",children:"Submitted:"}),e[52]=ae):ae=e[52];let X;e[53]!==r.updated_at?(X=r.updated_at?je(r.updated_at).format("MMM D, YYYY h:mm A"):"N/A",e[53]=r.updated_at,e[54]=X):X=e[54];let Z;e[55]!==X?(Z=t.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[ae,X]}),e[55]=X,e[56]=Z):Z=e[56];let ee;e[57]!==V||e[58]!==Z?(ee=t.jsxs("div",{className:"mt-4 flex flex-wrap gap-4",children:[V,Z]}),e[57]=V,e[58]=Z,e[59]=ee):ee=e[59],e[60]!==J||e[61]!==K||e[62]!==ee?(h=t.jsxs("div",{children:[J,K,ee]}),e[60]=J,e[61]=K,e[62]=ee,e[63]=h):h=e[63],b="relative",v="sticky bottom-6 z-50 flex min-w-[140px] flex-col items-center rounded-xl border border-gray-100 bg-gray-50 p-4 shadow-lg transition-all duration-500 ease-in-out",e[64]===Symbol.for("react.memo_cache_sentinel")?(g=t.jsx("span",{className:"mb-1 text-xs font-semibold tracking-wider text-gray-500 uppercase",children:"Total Score"}),e[64]=g):g=e[64],M="text-4xl font-black text-gray-900",w=te.toFixed(0),A="text-lg font-medium text-gray-400",N="/",E=se.toFixed(0),e[12]=f,e[13]=s.description,e[14]=s.questions,e[15]=s.title,e[16]=r.status,e[17]=r.updated_at,e[18]=d,e[19]=_,e[20]=w,e[21]=v,e[22]=g,e[23]=b,e[24]=j,e[25]=h,e[26]=S,e[27]=k,e[28]=C,e[29]=P,e[30]=q,e[31]=A,e[32]=N,e[33]=E,e[34]=M,e[35]=te,e[36]=se}else _=e[19],w=e[20],v=e[21],g=e[22],b=e[23],j=e[24],h=e[25],S=e[26],k=e[27],C=e[28],P=e[29],q=e[30],A=e[31],N=e[32],E=e[33],M=e[34],te=e[35],se=e[36];let Q;e[65]!==A||e[66]!==N||e[67]!==E?(Q=t.jsxs("span",{className:A,children:[N,E]}),e[65]=A,e[66]=N,e[67]=E,e[68]=Q):Q=e[68];let B;e[69]!==w||e[70]!==Q||e[71]!==M?(B=t.jsxs("div",{className:M,children:[w,Q]}),e[69]=w,e[70]=Q,e[71]=M,e[72]=B):B=e[72];const ce=te/se*100;let D;e[73]!==ce?(D=ce.toFixed(1),e[73]=ce,e[74]=D):D=e[74];let O;e[75]!==D?(O=t.jsxs("div",{className:"mt-1 text-xs font-medium text-green-600",children:[D,"%"]}),e[75]=D,e[76]=O):O=e[76];let R;e[77]!==v||e[78]!==g||e[79]!==B||e[80]!==O?(R=t.jsxs("div",{className:v,children:[g,B,O]}),e[77]=v,e[78]=g,e[79]=B,e[80]=O,e[81]=R):R=e[81];let Y;e[82]!==b||e[83]!==R?(Y=t.jsx("div",{className:b,children:R}),e[82]=b,e[83]=R,e[84]=Y):Y=e[84];let H;e[85]!==j||e[86]!==h||e[87]!==Y?(H=t.jsxs("div",{className:j,children:[h,Y]}),e[85]=j,e[86]=h,e[87]=Y,e[88]=H):H=e[88];let I;e[89]!==S||e[90]!==H?(I=t.jsx("div",{className:S,children:H}),e[89]=S,e[90]=H,e[91]=I):I=e[91];let ie;e[92]===Symbol.for("react.memo_cache_sentinel")?(ie=t.jsx("h3",{className:"px-2 text-xl font-bold text-gray-900",children:"Detailed Breakdown"}),e[92]=ie):ie=e[92];let z;if(e[93]!==f||e[94]!==s.questions||e[95]!==o){let F;e[97]!==f||e[98]!==o?(F=($,T)=>t.jsxs(we,{className:"transition-shadow hover:shadow-md",children:[t.jsxs(_e,{className:"flex items-center justify-between py-3",children:[t.jsxs("span",{className:"font-bold text-gray-500",children:["Question ",T+1]}),t.jsx("span",{className:"rounded border bg-white px-2 py-1 font-mono text-xs text-gray-400",children:$.type.replace("_"," ").toUpperCase()})]}),t.jsx(Ne,{children:t.jsx(qe,{question:$,answers:f[$.id]||[],onTeacherScore:o})})]},$.id),e[97]=f,e[98]=o,e[99]=F):F=e[99],z=s.questions.map(F),e[93]=f,e[94]=s.questions,e[95]=o,e[96]=z}else z=e[96];let U;e[100]!==m?(U=t.jsx("div",{className:"flex justify-end",children:t.jsx("button",{type:"submit",disabled:m,className:"rounded bg-blue-600 px-6 py-2 text-white hover:bg-blue-700 transition-colors disabled:opacity-50",children:"Submit Scores"})}),e[100]=m,e[101]=U):U=e[101];let W;e[102]!==z||e[103]!==U?(W=t.jsxs("div",{className:"space-y-6",children:[ie,z,U]}),e[102]=z,e[103]=U,e[104]=W):W=e[104];let G;e[105]!==k||e[106]!==C||e[107]!==I||e[108]!==W?(G=t.jsxs("form",{onSubmit:k,className:C,children:[I,W]}),e[105]=k,e[106]=C,e[107]=I,e[108]=W,e[109]=G):G=e[109];let ne;return e[110]!==_||e[111]!==P||e[112]!==q||e[113]!==G?(ne=t.jsxs(_,{breadcrumbs:P,children:[q,G]}),e[110]=_,e[111]=P,e[112]=q,e[113]=G,e[114]=ne):ne=e[114],ne}function Fe(a,e){return a+parseFloat(e.point)}function Ae(a,e){return a[e.question_id]=[{question_id:e.question_id,manual_score:e.manual_score}],a}function $e(){return alert("Failed to submit scores.")}function Te(){return alert("Scores submitted successfully!")}function Le(a){return{question_id:a.question_id,manual_score:a.manual_score??0}}function Ee(a){return a.option_text}function Me(a,e){return t.jsx("li",{children:a},e)}export{kt as default};
