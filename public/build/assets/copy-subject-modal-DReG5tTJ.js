import{c as W,u as Y,a as Z,j as s,t as Q}from"./app-BEjprfpt.js";import{B as U}from"./button-DGod-GTx.js";import{B as ee}from"./badge-DVoRCxHz.js";import{C as se,a as te,b as le,c as ae,d as re,e as oe}from"./command-CmqXW0w-.js";import{D as ie,a as ce,b as ne,c as me,d as de}from"./dialog-isigwEAQ.js";import{L as pe}from"./label-tp4e9AWt.js";import{P as fe,a as ue,b as he}from"./popover-B1sOJ-pt.js";import{s as xe}from"./index-ikzcNs2d.js";import{X as je}from"./x-9rjc8L--.js";import{C as ge}from"./check-DNy6Q5Gp.js";import"./app-C2HJU6IN.js";import"./index-sZL0LmKN.js";import"./index-joJZZ6T8.js";import"./index-CHXMgrNC.js";import"./utils-CFcDjcb_.js";import"./index-rsEto4aw.js";import"./index-Db_ipX0A.js";import"./index-CVovHSZ1.js";import"./search-BL-QF0Rx.js";import"./createLucideIcon-SD458vc9.js";import"./index-DsHUgfkw.js";import"./index-DH1X2cpJ.js";import"./index-DU3jUZ6J.js";import"./index-Da8MCGzP.js";import"./index-Brhvp-qm.js";import"./index-Bnui9FJL.js";function Je(A){const e=W.c(69),{isOpen:r,setIsOpen:f,subjectToCopy:o,availableClasses:c,sourceClassId:n}=A;let _;if(e[0]!==c||e[1]!==n){let t;e[3]!==n?(t=a=>a.id!==n,e[3]=n,e[4]=t):t=e[4],_=c.filter(t),e[0]=c,e[1]=n,e[2]=_}else _=e[2];const G=_;let w;e[5]===Symbol.for("react.memo_cache_sentinel")?(w={targets:[]},e[5]=w):w=e[5];const{data:l,setData:D,post:H,processing:S,errors:M,reset:X}=Y(w);let T;e[6]!==r||e[7]!==X?(T=()=>{r&&X("targets")},e[6]=r,e[7]=X,e[8]=T):T=e[8];let $;e[9]!==r?($=[r],e[9]=r,e[10]=$):$=e[10],Z.useEffect(T,$);const d=l.targets.length;let E;if(e[11]!==c||e[12]!==l.targets){let t;e[14]!==c?(t=a=>{const i=c.find(p=>p.id.toString()===a.class_id);return i?{key:a.class_id,label:i.name,classId:a.class_id}:null},e[14]=c,e[15]=t):t=e[15],E=l.targets.map(t).filter(be),e[11]=c,e[12]=l.targets,e[13]=E}else E=e[13];const I=E;let P;e[16]!==l.targets||e[17]!==D?(P=(t,a)=>{if(a){const i=l.targets.filter(p=>p.class_id!==t);D("targets",i)}else D("targets",[...l.targets,{class_id:t}])},e[16]=l.targets,e[17]=D,e[18]=P):P=e[18];const m=P;let B;e[19]!==l||e[20]!==M||e[21]!==H||e[22]!==f||e[23]!==n||e[24]!==o.id||e[25]!==o.name||e[26]!==d?(B=t=>{if(t.preventDefault(),l.targets.length===0){Q.error("Please select at least one Class to copy the subject to.");return}H(xe("instructor.classes.subjects.copy",{class:n,subject:o.id}),{data:l,preserveScroll:!0,onSuccess:()=>{Q.success(`Subject "${o.name}" copied successfully to ${d} class(es)!`),f(!1)},onError:a=>{console.error("Inertia Errors:",M),Q.error("Failed to copy subject. Please try again.")}})},e[19]=l,e[20]=M,e[21]=H,e[22]=f,e[23]=n,e[24]=o.id,e[25]=o.name,e[26]=d,e[27]=B):B=e[27];const q=B;let k;e[28]===Symbol.for("react.memo_cache_sentinel")?(k=s.jsx(ne,{children:"Copy Subject"}),e[28]=k):k=e[28];let u;e[29]!==o.name?(u=s.jsxs(ie,{children:[k,s.jsxs(ce,{children:["Duplicate ",s.jsxs("strong",{children:['"',o.name,'"']})," to another Classroom. (The original class is excluded)."]})]}),e[29]=o.name,e[30]=u):u=e[30];let O;e[31]===Symbol.for("react.memo_cache_sentinel")?(O=s.jsx(pe,{className:"font-semibold",children:"Copy To"}),e[31]=O):O=e[31];let h;e[32]!==I||e[33]!==m?(h=I.length>0&&s.jsx("div",{className:"flex flex-wrap gap-2 pt-1",children:I.map(t=>s.jsxs(ee,{variant:"secondary",className:"flex items-center space-x-1 pr-1",children:[t.label,s.jsx("button",{type:"button",onClick:()=>{m(t.classId,!0)},className:"p-0.5 rounded-full hover:bg-red-500/20 transition-colors",children:s.jsx(je,{className:"h-3 w-3"})})]},t.key))}),e[32]=I,e[33]=m,e[34]=h):h=e[34];const z=d===0?"Select Target Classes":`${d} Class${d>1?"es":""} Selected`;let x;e[35]!==S||e[36]!==z?(x=s.jsx(fe,{asChild:!0,children:s.jsx(U,{variant:"outline",className:"w-full justify-between",disabled:S,children:z})}),e[35]=S,e[36]=z,e[37]=x):x=e[37];let L;e[38]===Symbol.for("react.memo_cache_sentinel")?(L=s.jsx("div",{className:"border-b px-3 py-2",children:s.jsx(se,{placeholder:"Search class..."})}),e[38]=L):L=e[38];let F;e[39]===Symbol.for("react.memo_cache_sentinel")?(F=s.jsx(te,{className:"p-3 text-sm",children:"No other classes found."}),e[39]=F):F=e[39];let j;if(e[40]!==G||e[41]!==l.targets||e[42]!==m){let t;e[44]!==l.targets||e[45]!==m?(t=a=>{const i=a.id.toString(),p=l.targets.some(V=>V.class_id===i);return s.jsxs(le,{onSelect:()=>m(i,p),value:`class-${a.name}-${i}`,className:"flex cursor-pointer items-center justify-between px-3 py-2",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-blue-100 text-blue-800 font-bold",children:a.name.charAt(0)}),s.jsx("span",{className:"font-semibold",children:a.name})]}),s.jsx("div",{className:`flex h-5 w-5 items-center justify-center rounded-full border ${p?"border-blue-600 bg-blue-600 text-white":"border-gray-400"}`,children:p&&s.jsx(ge,{className:"h-3 w-3"})})]},i)},e[44]=l.targets,e[45]=m,e[46]=t):t=e[46],j=G.map(t),e[40]=G,e[41]=l.targets,e[42]=m,e[43]=j}else j=e[43];let g;e[47]!==j?(g=s.jsx(ue,{className:"max-h-80 w-full overflow-hidden p-0",children:s.jsxs(ae,{children:[L,s.jsxs(re,{className:"max-h-72 overflow-y-auto",children:[F,s.jsx(oe,{children:j})]})]})}),e[47]=j,e[48]=g):g=e[48];let b;e[49]!==x||e[50]!==g?(b=s.jsxs(he,{children:[x,g]}),e[49]=x,e[50]=g,e[51]=b):b=e[51];let y;e[52]!==h||e[53]!==b?(y=s.jsxs("div",{className:"grid gap-2",children:[O,h,b]}),e[52]=h,e[53]=b,e[54]=y):y=e[54];const J=S||d===0,K=S?"Copying...":"Copy Subject";let C;e[55]!==J||e[56]!==K?(C=s.jsx("div",{className:"flex justify-end pt-4",children:s.jsx(U,{type:"submit",disabled:J,children:K})}),e[55]=J,e[56]=K,e[57]=C):C=e[57];let v;e[58]!==q||e[59]!==y||e[60]!==C?(v=s.jsxs("form",{onSubmit:q,children:[y,C]}),e[58]=q,e[59]=y,e[60]=C,e[61]=v):v=e[61];let N;e[62]!==v||e[63]!==u?(N=s.jsxs(me,{className:"sm:max-w-[425px]",children:[u,v]}),e[62]=v,e[63]=u,e[64]=N):N=e[64];let R;return e[65]!==r||e[66]!==f||e[67]!==N?(R=s.jsx(de,{open:r,onOpenChange:f,children:N}),e[65]=r,e[66]=f,e[67]=N,e[68]=R):R=e[68],R}function be(A){return A!==null}export{Je as default};
